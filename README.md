# _MASCO_

## Описание:
Реализация модели MASCO с первым порядком аппроксимации, написанная на языке Python. Позволяет расчитывать вероятность заданного коалесцентного дерева. Работа с программой возможна через командную строку.

## Настройка начальных данных:
Начальные денные читаются из файлов "coefficients", "migration_rates" и "Newick_tree", находящихся папке со скриптом.

В файле "coefficients" можно настроить следующие параметры:
  1) m - количество популяций
  2) n - колличество образцов в каждой популяции (следует записать числа в int формате через пробел без прочих разделителей, колличество чисел должно быть равно m)
  3) q - частоты коалесценции в каждой популяции (следует записать числа в int формате через пробел без прочих разделителей, колличество чисел должно быть равно m)

В файле "migration_rates" необходимо указать матрицу с частотами миграции между популяциями. Размер матрицы должен быть m на m, элементы - положительные числа в формате double. Элементы главной диагонали матрицы должны быть нулевыми.

В бинарном файле "tree_history.bin" задаётся история миграций и коалесценций линий в течении времени в следующем формате:

В самом верху бинарного файла записано число типа unsigned int, хранящее TMRCA. Далее каждое событие (миграция или коалесценция) описывается пятью интовыми числами, тип события определяется перым числом в пятёрке: 0 для коалесценции и 1 для миграции.

В случае коалесценции остальные 4 числа обозначают следующее: номер популяции, в которой произошла коалесценция, первый коалесцирующий образец (всегда с меньшим Id), второй коалесцирующий образец (всегда с большим Id), время, в которое коалесценция произошла.

Вслучае миграции остальные 4 числа обозначают следующее: номер популяции, из которой мигрировал образец, номер популяции, в которую мигрировал образец, Id мигрирующего образца, время, в которой миграция произошла.

Нумерация как образцов, так и популяций ведётся с нуля.

В файлах "coefficients" и "migration_rates" можно делать строки с пометками для себя, добавляя в начало этих строк символ '#', таким образом эта строка никак не повлияет на выполнение кода.

## Запуск:
Запуск кода производится через консоль, без указания дополнительных параметров.

## Выход:
На выходе мы получаем вероятность заданного коалесцентного дерева, то есть одно число в формате float, отображаемое в консоли.
